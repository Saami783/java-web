<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/base}">
<head>
    <title th:text="${pageTitle}">Détail du véhicule</title>
</head>
<body>

<section layout:fragment="content">
    <br><br><br><br>
    <h1 th:text="${vehicule.modele}">Modèle du véhicule</h1>
    <p>Caution: <span th:text="${vehicule.caution} + '€'">Caution</span></p>
    <p>Nombre de places: <span th:text="${vehicule.nbPlace}">Nombre de places</span></p>
    <h3>Tarifs:</h3>
    <ul>
        <li th:each="tarif : ${vehicule.tarifs}">
            <span th:text="${tarif.calendrier} + ' : ' + ${tarif.prix} + '€'">Tarif</span>
        </li>
    </ul>
    <p>Catégorie: <span th:text="${vehicule.categorie.libelle}">Catégorie</span></p>

    <h3>Images:</h3>
    <div th:each="image : ${vehicule.images}">
        <img th:src="@{'/uploads/img/vehicules/' + ${vehicule.folder} + '/' + ${image.imagePath}}"
             alt="Image du véhicule"/>
    </div>

    <h3>Réserver ce véhicule</h3>
    <div th:if="${error}" class="alert alert-danger">
        <p th:text="${error}">Message d'erreur</p>
    </div>

    <div th:unless="${vehicule.disponible}">
        <p class="alert alert-info">Ce véhicule n'est actuellement pas disponible pour la réservation.</p>
    </div>

    <form th:action="@{/reservations/create}" th:object="${reservation}" method="post">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
        <div>
            <label for="dateDebutReservation">Date de début:</label>
            <input type="date" id="dateDebutReservation" th:field="*{dateDebutReservation}" required>
        </div>
        <div>
            <label for="dateFinReservation">Date de fin:</label>
            <input type="date" id="dateFinReservation" th:field="*{dateFinReservation}" required>
        </div>
        <input type="hidden" th:field="*{vehicule.id}"/>
        <button type="submit" class="btn btn-primary">Réserver ce véhicule</button>
    </form>

    <br/>
    <br/>

    <form th:action="@{/avis/create}" th:object="${avisForm}" method="post">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
        <div>
            <label for="commentaire">Commentaire:</label><br/>
            <textarea id="commentaire" name="commentaire" th:field="*{commentaire}" required cols="30"></textarea>
        </div>
        <div>
            <label for="note">Note:</label>
            <input type="number" id="note" min="1" max="5" maxlength="1" th:field="*{note}" required>
        </div>
        <input type="hidden" th:field="${vehicule.id}"/>
        <button type="submit" class="btn btn-primary">Publier mon avis</button>
    </form>
</section>


<section>
    <div th:unless="${#lists.isEmpty(avisList)}">
        <div th:each="avis : ${avisList}">
            <p>Note: <span th:text="${avis.note}">Note Value</span></p>
            <p>Commentaire: <span th:text="${avis.commentaire}">Commentaire</span></p>
        </div>
    </div>

    <!-- Display message if no avis exist -->
    <div th:if="${#lists.isEmpty(avisList)}">
        <p class="alert alert-danger">Aucun avis pour ce véhicule</p>
    </div>
</section>



</body>
</html>
